# MakeSkip

用于快捷制作pss、frs等特殊阵设。

**本插件完全不具备健壮性（反正写内存写错了本来就不可避免会崩溃），请多加注意。**

**强烈建议在修改前先备份存档，一旦修改出错对存档的打击是毁灭性的！！！**

## 运行环境

针对 AvZ1 2022_10_01 版本开发。

## 函数使用示例

注：本插件的函数分别放入两个类，其中Once类中的函数在进入游戏后立即生效一次，Keep类中的函数在进入游戏后会持续生效。

### 放置植物/僵尸
这部分功能没有加入两个类中。这两个函数在avz2是内置的，此处实际上是对标avz2做的补充。

注意此处相对于avz2的函数做了修改：
* 行数、列数按日常交流用语从1开始计，
* 生成僵尸用的是横坐标而非列数，
* 返回的是编号而非指针。

```cpp
// 在一路放置一只横坐标为780的普通僵尸，返回僵尸的编号
PutZombie(1, 780, ZOMBIE);

// 在一路一列放置一只向日葵，返回植物的编号
PutPlant(1, 1, SUNFLOWER);
```

### frs：销毁和复制

销毁：
```cpp
// 销毁类型为 PLANT_MAIN(植物本体动画), 编号为0的对象的动画
// 植物与僵尸拥有多个动画，绝大多数时候使用的都是其本体动画 PLANT_MAIN 和 ZOMBIE_MAIN
Once::DeleteAnimation(PLANT_MAIN, 0);
```

全复制：
```cpp
// 以PP模式将 编号为0的对象的本体动画ID 复制给 编号为1(和2)的对象
// 模式共有4种：
// PP: 植物 本体动画ID复制给 植物
// PZ: 植物 本体动画ID复制给 僵尸
// ZP: 僵尸 本体动画ID复制给 植物
// ZZ: 僵尸 本体动画ID复制给 僵尸
Once::CopyAnimationId(PP, 0, 1);
Once::CopyAnimationId(PP, 0, {1, 2});

// 将类型为PLANT_HEAD_1, 编号为0的对象的动画ID 复制给 类型为PLANT_MAIN, 编号为1的对象
// 如果只需复制本体动画，无需选择该函数
Once::CopyAnimationId(PLANT_HEAD_1, 0, PLANT_MAIN, 1);
```

半复制：
```cpp
// 以PP模式将 编号为0的对象的本体动画编号 复制给 编号为1(和2)的对象
Once::CopyAnimationIndex(PP, 0, 1);
Once::CopyAnimationIndex(PP, 0, {1, 2});

// 将类型为PLANT_HEAD_1, 编号为0的对象的动画编号 复制给 类型为PLANT_MAIN, 编号为1的对象
// 如果只需复制本体动画，无需选择该函数
Once::CopyAnimationIndex(PLANT_HEAD_1, 0, PLANT_MAIN, 1);
```

### frs：固定动画

该功能用于模拟压花盆固定动画。

存模仿者时，如果要消除生效时间波动，可将rate设为0.998064。

```cpp
// 将编号为0的植物的类型PLANT_MAIN的动画的动画速度设为0、动画进度默认保持不变
Once::LockAnimation(PLANT_MAIN, 0);
// 将编号为0的植物的类型PLANT_MAIN的动画的动画速度设为0、动画进度设为0.998064
Once::LockAnimation(PLANT_MAIN, 0, 0.998064);
```

### pss
常规pss：

该函数是最简单的运行pss的函数，不一定适用于所有植物、所有情况。
```cpp
// 将编号为1(和2)的植物设置为pss状态

Once::MakePss(1);
Once::MakePss({1, 2});
```

pss咖啡豆：

MakePss只针对第一阶段的咖啡豆有效，若咖啡豆开始消失则无效；本函数对任何阶段的咖啡豆均有效。
```cpp
// 将编号为1(和2)的咖啡豆设置为pss状态
Once::MakePssCoffee(1);
Once::MakePssCoffee({1, 2});

// 进入关卡后持续生效，将所有咖啡豆设置为pss状态
Keep::MakePssCoffee();
```

pss窝瓜：

可设置跳后坐标。
```cpp
// 将编号为1(和2)的窝瓜设置为pss状态，坐标设置为700 
Once::MakePssSquash(1, 700);
Once::MakePssSquash({1, 2}, 700);

// 将编号为1(和2)的窝瓜设置为pss状态，防御域右边界与八列炮(前轮)重合
// 植物防御域可选种类如下（含坐标偏移的请自行计算）：
// NORVAL_RECT:  普通植物
// COB_RECT:     炮
// TALLNUT_RECT: 高坚果
// PUMPKIN_RECT: 南瓜
Once::MakePssSquash(1, COB_RECT, 8);
Once::MakePssSquash({1, 2}, COB_RECT, 8);
```

## 一些待讨论的事项

很多地方我都没有决定下来怎样好啦，这里举一些例子：

1. 一次性生效和持续生效是否要区分、如何区分，我觉得自己都要被绕晕了就设置了两个class，但是是否有更好更规范的方式呢？
1. 一些操作（尤其是frs操作）光看函数名和注释可能不明白怎么操作，是否需要更多使用说明，但是frs本身确实有一定门槛，如何说明？
1. 例如pss植物、立棍撑杆等功能，是否要运用上PutPlant/PutZombie函数直接添加而不需要手动放置。
1. 头文件中的注释需不需要更好的写法？我看avz中的重载函数都是并在一起只在最前面写一个注释的，但是本插件中要是这么做似乎字太多了。
1. 这个README有没有更好或更规范的写法？例如pss窝瓜、pss咖啡豆这些是否需要分在不同小标题下。

欢迎大家提供使用反馈啦。～(∠・ω< )⌒★

本插件还在持续更新中，未来还会提供更多功能，计划完善后再移植到avz2。只是最近我实在有些累，更新进度十分缓慢，所以就先把目前完成的部分发上来一下了。

## 更新日志

### v0.2.0.2024_07_29

* 将函数分为Once和Keep两个类；
* 加入了直接放置植物或僵尸的函数；
* 加入了frs下属的半复制、固定动画函数；
* 加入了制造pss的函数，及专门制造pss咖啡豆、pss窝瓜的函数；
* 修正了readme.md的部分错误措辞。

### v0.1.0

* 加入了frs下属的销毁动画、全复制函数。